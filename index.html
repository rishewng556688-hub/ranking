<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>å¥–åŠ±æ’åç³»ç»Ÿ</title>

<style>
:root{
  --bg:#f4f6f9;
  --card:#ffffff;
  --primary:#2563eb;
  --danger:#dc2626;
  --border:#e5e7eb;
  --text:#1f2937;
  --muted:#6b7280;
}

body{
  margin:0;
  padding:30px;
  background:var(--bg);
  font-family:"Segoe UI","PingFang SC","Microsoft YaHei",sans-serif;
  color:var(--text);
}

h2{
  text-align:center;
  margin-bottom:20px;
  font-weight:600;
}

.card{
  max-width:1100px;
  margin:auto;
  background:var(--card);
  border-radius:14px;
  box-shadow:0 10px 25px rgba(0,0,0,.06);
  padding:20px;
}

.controls{
  display:flex;
  justify-content:space-between;
  align-items:center;
  flex-wrap:wrap;
  gap:10px;
  margin-bottom:15px;
}

.controls-left{
  display:flex;
  align-items:center;
  gap:10px;
}

select{
  padding:6px 12px;
  border-radius:8px;
  border:1px solid var(--border);
}

button{
  padding:7px 14px;
  border-radius:10px;
  border:none;
  cursor:pointer;
  font-size:14px;
}

.btn-primary{background:var(--primary);color:#fff;}
.btn-secondary{background:#e5e7eb;}
.btn-danger{background:var(--danger);color:#fff;}

table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  padding:12px;
  border-bottom:1px solid var(--border);
  text-align:center;
}

th{
  background:#f9fafb;
  color:var(--muted);
  font-weight:500;
}

tr:hover{background:#f9fafb;}

.top1{background:linear-gradient(90deg,#fff7cc,#fff);}
.top2{background:linear-gradient(90deg,#f1f5f9,#fff);}
.top3{background:linear-gradient(90deg,#fef3c7,#fff);}

.editable{
  padding:2px 6px;
  border-radius:6px;
  cursor:text;
}

.editable[contenteditable="true"]{
  background:#fff7cc;
  outline:1px dashed #f59e0b;
}

.action-btn{
  padding:5px 10px;
  font-size:12px;
}
</style>
</head>

<body>

<h2>ğŸ† å¥–åŠ±æ’åç³»ç»Ÿ</h2>

<div class="card">
  <div class="controls">
    <div class="controls-left">
      <span>æ’åä¾æ® / Ranking byï¼š</span>
      <select id="rankType" onchange="updateRanking();saveData();">
        <option value="performance">ä¸šç»© / Total Money</option>
        <option value="push">æ¨é€ / Clients Push</option>
        <option value="first">é¦–å­˜ / First Deposit</option>
      </select>
    </div>

    <div>
      <button class="btn-secondary" onclick="unlockEdit()">ğŸ”“ è§£é”ç¼–è¾‘</button>
      <button class="btn-primary" id="lockBtn" onclick="lockEdit()" style="display:none;">ğŸ”’ å®Œæˆç¼–è¾‘å¹¶é”å®š</button>
      <button class="btn-primary" onclick="addPerson()">â• æ·»åŠ äººå‘˜</button>
    </div>
  </div>

  <table id="rankingTable">
    <thead>
      <tr>
        <th>æ’å / Ranking</th>
        <th>å§“å / Name</th>
        <th>æ¨é€ / Clients Push</th>
        <th>é¦–å­˜ / First Deposit</th>
        <th>ä¸šç»© / Total Money</th>
        <th>æ“ä½œ / Action</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
const EDIT_PASSWORD="qwe556688.";
const STORAGE_KEY="ranking_system_data";
let isUnlocked=false;

const defaultData=[
  {name:"å¼ ä¸‰",push:120,first:50,performance:300},
  {name:"æå››",push:90,first:40,performance:250}
];

function unlockEdit(){
  const pwd=prompt("è¯·è¾“å…¥ç¼–è¾‘å¯†ç ï¼š");
  if(pwd!==EDIT_PASSWORD){
    alert("å¯†ç é”™è¯¯");
    return;
  }
  isUnlocked=true;
  document.querySelectorAll(".editable").forEach(e=>e.contentEditable="true");
  document.getElementById("lockBtn").style.display="inline-block";
  alert("å·²è¿›å…¥ç¼–è¾‘æ¨¡å¼");
}

function lockEdit(){
  isUnlocked=false;
  document.querySelectorAll(".editable").forEach(e=>e.contentEditable="false");
  document.getElementById("lockBtn").style.display="none";
  saveData();
  alert("å·²é”å®šï¼Œå½“å‰ä¸ºåªè¯»æ¨¡å¼");
}

function renderTable(data){
  const tbody=document.querySelector("#rankingTable tbody");
  tbody.innerHTML="";
  data.forEach(d=>{
    const tr=tbody.insertRow();
    tr.innerHTML=`
      <td></td>
      <td class="editable name">${d.name}</td>
      <td class="editable push">${d.push}</td>
      <td class="editable first">${d.first}</td>
      <td class="editable performance">${d.performance}</td>
      <td>
        <button class="btn-danger action-btn" onclick="deleteRow(this)">åˆ é™¤</button>
      </td>
    `;
    tr.querySelectorAll(".editable").forEach(el=>{
      el.contentEditable="false";
      el.addEventListener("input",()=>{
        if(!el.classList.contains("name")){
          el.innerText=el.innerText.replace(/[^\d]/g,"");
        }
        updateRanking();
        saveData();
      });
    });
  });
  updateRanking();
}

function addPerson(){
  if(!isUnlocked){
    alert("è¯·å…ˆè§£é”ç¼–è¾‘");
    return;
  }
  const name=prompt("è¯·è¾“å…¥å§“åï¼š");
  if(!name)return;
  const data=loadData();
  data.push({name,push:0,first:0,performance:0});
  saveData(data);
  renderTable(data);
}

function deleteRow(btn){
  if(!isUnlocked){
    alert("è¯·å…ˆè§£é”ç¼–è¾‘");
    return;
  }
  if(!confirm("ç¡®å®šåˆ é™¤è¯¥äººå‘˜ï¼Ÿ"))return;
  btn.closest("tr").remove();
  updateRanking();
  saveData();
}

function updateRanking(){
  const tbody=document.querySelector("#rankingTable tbody");
  const rows=[...tbody.rows];
  const type=document.getElementById("rankType").value;

  rows.sort((a,b)=>
    Number(b.querySelector("."+type).innerText) -
    Number(a.querySelector("."+type).innerText)
  );

  rows.forEach((r,i)=>{
    r.cells[0].innerText=i+1;
    r.classList.remove("top1","top2","top3");
    if(i===0)r.classList.add("top1");
    if(i===1)r.classList.add("top2");
    if(i===2)r.classList.add("top3");
    tbody.appendChild(r);
  });
}

function saveData(data){
  if(!data){
    data=[];
    document.querySelectorAll("#rankingTable tbody tr").forEach(r=>{
      data.push({
        name:r.querySelector(".name").innerText,
        push:+r.querySelector(".push").innerText,
        first:+r.querySelector(".first").innerText,
        performance:+r.querySelector(".performance").innerText
      });
    });
  }
  localStorage.setItem(STORAGE_KEY,JSON.stringify(data));
}

function loadData(){
  const raw=localStorage.getItem(STORAGE_KEY);
  return raw?JSON.parse(raw):defaultData;
}

renderTable(loadData());
</script>

</body>
</html>
